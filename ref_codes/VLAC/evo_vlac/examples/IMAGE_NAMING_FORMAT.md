# VLAC Examples 图像命名格式说明

## 命名格式原理

### 通用格式
```
{episode_id}-{frame_number}-{total_frames}-{camera_view}.jpg
```

### 格式组成部分

#### 1. Episode ID（轨迹ID）
- **ref images**: `599` - 参考轨迹的ID
- **test images**: `595` - 测试轨迹的ID

这个数字代表不同的演示轨迹/episode，每个ID对应一次独立的任务执行。

#### 2. Frame Number（帧编号）
表示该图像在整个轨迹中的时间位置（帧序号）

**Ref 序列（599）的帧编号：**
- `0` - 起始帧（0%进度）
- `100` - 第1个关键帧（~20%进度）
- `200` - 第2个关键帧（~40%进度）
- `300` - 第3个关键帧（~60%进度）
- `400` - 第4个关键帧（~80%进度）
- `457` - 结束帧（100%进度，总共457帧）

**Test 序列（595）的帧编号：**
- `6` - 接近起始（~1%进度，总共565帧）
- `44` - 早期阶段（~8%进度）
- `134` - 前期阶段（~24%进度）
- `139` - 前期阶段（~25%进度）
- `292` - 中期阶段（~52%进度）
- `354` - 后期阶段（~63%进度）

#### 3. Total Frames（总帧数）
表示该轨迹的总帧数

- **Ref 轨迹**: `521` 帧 ⚠️ **注意：虽然总共521帧，但最后一个关键帧是457**
- **Test 轨迹**: `565` 帧 ⚠️ **注意：虽然总共565帧，但采样到354帧为止**

#### 4. Camera View（相机视角）
表示相机/视角编号

- `0` - 相机视角0（例如：正面视角）
- `1` - 相机视角1（例如：侧面视角）
- `2` - 相机视角2（例如：俯视视角）

## 具体示例解析

### 示例 1: `599-0-521-0.jpg`
```
599    - Episode 599（ref轨迹）
0      - 第0帧（起始帧）
521    - 该轨迹总共521帧
0      - 相机视角0
```
**含义**: 参考轨迹599的起始状态，从相机0拍摄

### 示例 2: `599-457-521-2.jpg`
```
599    - Episode 599（ref轨迹）
457    - 第457帧（接近结束）
521    - 该轨迹总共521帧
2      - 相机视角2
```
**含义**: 参考轨迹599的结束状态（457/521 = 87.7%），从相机2拍摄

### 示例 3: `595-134-565-1.jpg`
```
595    - Episode 595（test轨迹）
134    - 第134帧
565    - 该轨迹总共565帧
1      - 相机视角1
```
**含义**: 测试轨迹595的中间状态（134/565 = 23.7%进度），从相机1拍摄

## 数据组织逻辑

### Ref Images（参考演示）
- **目的**: 提供完整的任务演示轨迹
- **采样策略**: 均匀采样6个关键帧，覆盖从开始到结束
- **帧间隔**: 约100帧（0, 100, 200, 300, 400, 457）
- **用途**: 作为模型的参考示例（visual_demo），帮助模型理解任务

### Test Images（待评估轨迹）
- **目的**: 提供需要评估进度的轨迹片段
- **采样策略**: 非均匀采样6个帧，覆盖不同进度阶段
- **特点**:
  - 起始阶段密集采样（6, 44）
  - 前期有两个接近的帧（134, 139）用于测试模型对相近状态的区分能力
  - 中后期采样（292, 354）
- **用途**: 作为需要估计进度的输入（stage_to_estimate）

## 为什么这样设计？

### 1. Episode ID 分离
- 不同的 episode ID（599 vs 595）表示不同的轨迹执行
- 即使是相同的任务，不同执行会有轨迹差异
- 这测试模型的泛化能力（能否从599的演示推广到595的评估）

### 2. 总帧数不同
- ref: 521帧，test: 565帧
- 说明两次执行的速度/时长不同
- 模型需要理解相对进度，而非绝对帧数

### 3. 非均匀采样（Test）
- 故意设计一些接近的帧（134, 139）
- 测试模型对细微进度差异的敏感度
- 更符合真实场景（关键步骤可能发生在短时间内）

### 4. 多视角设计
- 3个相机视角提供不同观察角度
- 测试模型的视角不变性
- 在实际应用中，可能只有某些视角可用

## 在 JSONL 中的使用

```json
{
  "visual_demo": [
    "images/ref/599-0-521-0.jpg",      # 0% 进度
    "images/ref/599-100-521-0.jpg",    # 20% 进度
    "images/ref/599-200-521-0.jpg",    # 40% 进度
    "images/ref/599-300-521-0.jpg",    # 60% 进度
    "images/ref/599-400-521-0.jpg",    # 80% 进度
    "images/ref/599-457-521-0.jpg"     # 100% 进度
  ],
  "stage_to_estimate": [
    "images/test/595-134-565-0.jpg"    # 需要评估的帧（约24%）
  ]
}
```

## 关键洞察

1. **帧编号 ≠ 进度百分比**
   - 帧编号是绝对位置
   - 进度需要计算：`frame_number / total_frames`

2. **同一时刻的多视角**
   - `595-134-565-{0,1,2}.jpg` 是同一时刻的3个视角
   - 只是观察角度不同，任务状态相同

3. **跨轨迹对比**
   - Ref（599）的某个进度阶段 vs Test（595）的某个阶段
   - 模型需要识别"任务完成度"而非"具体帧位置"

4. **稀疏采样策略**
   - 不是每一帧都保存，只保存关键帧
   - 减少存储，同时保留关键信息
